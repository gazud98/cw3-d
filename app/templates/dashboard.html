{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<style>
    .card-hover:hover {
        transform: translateY(-5px);
        transition: 0.3s ease;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    .fade-in {
        animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
            transform: translateY(-10px);
        }

        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<div class="container py-4 fade-in">
    <h2 class="mb-4">Bienvenido, {{ usuario }}</h2>

    <!-- Notificación si hay nuevas solicitudes -->
    {% if nuevas_solicitudes > 0 %}
    <div class="alert alert-warning d-flex align-items-center shadow-sm rounded-3 fade-in" role="alert">
        <i class="bi bi-bell-fill fs-4 me-3 text-warning"></i>
        <div class="flex-grow-1">
            Tienes <strong>{{ nuevas_solicitudes }}</strong> solicitud(es) pendiente(s) de revisión.
        </div>
        <a href="{{ url_for('solicitudes.vista_solicitudes_revision') }}" class="btn btn-sm btn-outline-dark ms-3">
            Ver solicitudes
        </a>
    </div>
    {% endif %}
    {% if nuevas_respuestas %}
    <div class="alert alert-info d-flex align-items-start gap-3 shadow-sm" role="alert">
        <div><i class="bi bi-info-circle fs-4 text-primary"></i></div>
        <div>
            <strong>Actualizaciones recientes:</strong>
            <ul class="mb-0 small">
                {% for r in nuevas_respuestas %}
                <li>
                    Tu solicitud para <strong>{{ r.documento.nombre }}</strong>
                    fue <strong>{{ 'aprobada' if r.estado == 2 else 'rechazada' }}</strong>
                    el {{ r.fecha_revisado.strftime('%d/%m/%Y a las %H:%M') }}.
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}


    <!-- Tarjetas de resumen -->
    <div class="row g-4 mt-3">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm card-hover h-100">
                <div class="card-body text-center">
                    <i class="bi bi-clock-history fs-1 text-primary mb-2"></i>
                    <h5 class="card-title">Solicitudes Pendientes</h5>
                    <p class="display-6 fw-bold text-dark">{{ solicitudes_pendientes }}</p>
                    <a href="{{ url_for('solicitudes.vista_solicitudes_revision') }}"
                        class="btn btn-outline-primary btn-sm mt-2">Ir al listado</a>
                </div>
            </div>
        </div>

        <!-- Tarjeta adicional no dinámica -->
        <div class="col-md-4">
            <div class="card border-0 shadow-sm card-hover h-100">
                <div class="card-body text-center">
                    <i class="bi bi-check-circle-fill fs-1 text-success mb-2"></i>
                    <h5 class="card-title">Estado General</h5>
                    <p class="text-muted">Estás al día con tus registros.</p>
                    <span class="badge bg-success px-3 py-2">Sin alertas</span>
                </div>
            </div>
        </div>

        <!-- Otra tarjeta opcional -->
        <div class="col-md-4">
            <div class="card border-0 shadow-sm card-hover h-100">
                <div class="card-body text-center">
                    <i class="bi bi-file-earmark-check fs-1 text-info mb-2"></i>
                    <h5 class="card-title">Última Actividad</h5>
                    <p class="text-muted">Hace menos de 24 horas.</p>
                    <span class="badge bg-info px-3 py-2">Actualizado</span>
                </div>
            </div>
        </div>
    </div>
</div>

{% set mostrar_navbar = True %}
{% endblock %}